================================================================================
                    GIáº¢I THÃCH Vá»€ Báº¢NG MAGIC_LINKS
================================================================================

ğŸ“§ MAGIC LINK LÃ€ GÃŒ?
--------------------
Magic Link (Link ma thuáº­t) lÃ  má»™t phÆ°Æ¡ng thá»©c Ä‘Äƒng nháº­p KHÃ”NG Cáº¦N Máº¬T KHáº¨U.
Thay vÃ¬ nháº­p máº­t kháº©u, ngÆ°á»i dÃ¹ng chá»‰ cáº§n nháº­p email vÃ  nháº­n má»™t link Ä‘áº·c biá»‡t
qua email Ä‘á»ƒ Ä‘Äƒng nháº­p.

================================================================================
ğŸ¯ TÃC Dá»¤NG Cá»¦A Báº¢NG MAGIC_LINKS
================================================================================

1. ÄÄ‚NG NHáº¬P NHANH KHÃ”NG Cáº¦N Máº¬T KHáº¨U
   - NgÆ°á»i dÃ¹ng (talent hoáº·c client) chá»‰ cáº§n nháº­p email
   - Há»‡ thá»‘ng gá»­i má»™t link Ä‘áº·c biá»‡t Ä‘áº¿n email
   - Click vÃ o link â†’ Tá»± Ä‘á»™ng Ä‘Äƒng nháº­p
   - KhÃ´ng cáº§n nhá»› máº­t kháº©u!

2. Báº¢O Máº¬T CAO
   - Má»—i link chá»‰ cÃ³ thá»ƒ sá»­ dá»¥ng 1 láº§n
   - Link cÃ³ thá»i gian háº¿t háº¡n (15 phÃºt)
   - Token Ä‘Æ°á»£c mÃ£ hÃ³a báº±ng Hash
   - Chá»‰ ngÆ°á»i cÃ³ quyá»n truy cáº­p email má»›i cÃ³ thá»ƒ Ä‘Äƒng nháº­p

3. TRáº¢I NGHIá»†M NGÆ¯á»œI DÃ™NG Tá»T HÆ N
   - KhÃ´ng cáº§n nhá»› máº­t kháº©u phá»©c táº¡p
   - ÄÄƒng nháº­p nhanh chá»‰ vá»›i 1 click
   - Giáº£m tá»· lá»‡ quÃªn máº­t kháº©u

================================================================================
ğŸ“‹ Cáº¤U TRÃšC Báº¢NG MAGIC_LINKS
================================================================================

Cá»™t                | MÃ´ táº£
-------------------|----------------------------------------------------------
id                 | ID tá»± Ä‘á»™ng tÄƒng
email              | Email cá»§a ngÆ°á»i dÃ¹ng muá»‘n Ä‘Äƒng nháº­p
token              | Token duy nháº¥t (64 kÃ½ tá»±, Ä‘Ã£ mÃ£ hÃ³a báº±ng Hash)
user_type          | Loáº¡i ngÆ°á»i dÃ¹ng: 'talent' hoáº·c 'client'
expires_at         | Thá»i gian háº¿t háº¡n (thÆ°á»ng lÃ  15 phÃºt sau khi táº¡o)
used               | ÄÃ£ sá»­ dá»¥ng chÆ°a (true/false) - chá»‰ dÃ¹ng 1 láº§n
created_at         | Thá»i gian táº¡o
updated_at         | Thá»i gian cáº­p nháº­t

================================================================================
ğŸ”„ QUY TRÃŒNH HOáº T Äá»˜NG
================================================================================

BÆ¯á»šC 1: NGÆ¯á»œI DÃ™NG YÃŠU Cáº¦U MAGIC LINK
   - VÃ o trang Ä‘Äƒng nháº­p
   - Click "ÄÄƒng nháº­p nhanh báº±ng email" hoáº·c "Magic Link"
   - Nháº­p email cá»§a mÃ¬nh
   - Click "Gá»­i link"

BÆ¯á»šC 2: Há»† THá»NG Táº O VÃ€ LÆ¯U TOKEN
   - Kiá»ƒm tra email cÃ³ tá»“n táº¡i trong há»‡ thá»‘ng khÃ´ng
   - Táº¡o token ngáº«u nhiÃªn (64 kÃ½ tá»±)
   - MÃ£ hÃ³a token báº±ng Hash
   - LÆ°u vÃ o báº£ng magic_links:
     * email: email ngÆ°á»i dÃ¹ng
     * token: token Ä‘Ã£ mÃ£ hÃ³a
     * user_type: 'talent' hoáº·c 'client'
     * expires_at: thá»i gian hiá»‡n táº¡i + 15 phÃºt
     * used: false

BÆ¯á»šC 3: Gá»¬I EMAIL CHá»¨A LINK
   - Táº¡o link Ä‘Äƒng nháº­p: /talent/login/magic/{token}
   - Gá»­i email chá»©a link nÃ y Ä‘áº¿n ngÆ°á»i dÃ¹ng
   - Email cÃ³ ná»™i dung: "Click vÃ o link Ä‘á»ƒ Ä‘Äƒng nháº­p"

BÆ¯á»šC 4: NGÆ¯á»œI DÃ™NG CLICK LINK
   - NgÆ°á»i dÃ¹ng má»Ÿ email vÃ  click vÃ o link
   - Link sáº½ dáº«n Ä‘áº¿n: /talent/login/magic/{token}

BÆ¯á»šC 5: Há»† THá»NG XÃC THá»°C VÃ€ ÄÄ‚NG NHáº¬P
   - Há»‡ thá»‘ng nháº­n token tá»« URL
   - TÃ¬m trong báº£ng magic_links:
     * Token khá»›p (sau khi hash)
     * expires_at > thá»i gian hiá»‡n táº¡i (chÆ°a háº¿t háº¡n)
     * used = false (chÆ°a sá»­ dá»¥ng)
   - Náº¿u há»£p lá»‡:
     * Tá»± Ä‘á»™ng Ä‘Äƒng nháº­p ngÆ°á»i dÃ¹ng
     * ÄÃ¡nh dáº¥u used = true (khÃ´ng thá»ƒ dÃ¹ng láº¡i)
     * XÃ³a hoáº·c giá»¯ láº¡i record (tÃ¹y thiáº¿t káº¿)
   - Náº¿u khÃ´ng há»£p lá»‡:
     * Hiá»ƒn thá»‹ lá»—i: "Link khÃ´ng há»£p lá»‡ hoáº·c Ä‘Ã£ háº¿t háº¡n"

================================================================================
ğŸ’¡ VÃ Dá»¤ Cá»¤ THá»‚
================================================================================

TÃŒNH HUá»NG: Talent muá»‘n Ä‘Äƒng nháº­p nhanh

1. Talent vÃ o trang: /talent/login
2. Click "ÄÄƒng nháº­p nhanh báº±ng email"
3. Nháº­p email: talent1@vietlance.com
4. Click "Gá»­i link"

â†’ Há»‡ thá»‘ng táº¡o record trong magic_links:
   - email: talent1@vietlance.com
   - token: $2y$12$abc123...xyz789 (Ä‘Ã£ hash)
   - user_type: talent
   - expires_at: 2025-12-11 10:15:00 (15 phÃºt sau)
   - used: false

â†’ Gá»­i email Ä‘áº¿n talent1@vietlance.com vá»›i link:
   https://vietlance.com/talent/login/magic/abc123xyz789

5. Talent má»Ÿ email vÃ  click link

â†’ Há»‡ thá»‘ng kiá»ƒm tra:
   - Token "abc123xyz789" â†’ hash â†’ so sÃ¡nh vá»›i token trong DB
   - expires_at > now() â†’ OK
   - used = false â†’ OK

â†’ ÄÄƒng nháº­p thÃ nh cÃ´ng!
â†’ Cáº­p nháº­t: used = true

6. Náº¿u talent click láº¡i link Ä‘Ã³ láº§n ná»¯a
â†’ Há»‡ thá»‘ng kiá»ƒm tra: used = true â†’ Tá»« chá»‘i
â†’ Hiá»ƒn thá»‹: "Link Ä‘Ã£ Ä‘Æ°á»£c sá»­ dá»¥ng"

================================================================================
ğŸ”’ Báº¢O Máº¬T
================================================================================

1. TOKEN ÄÆ¯á»¢C MÃƒ HÃ“A
   - Token trong database Ä‘Æ°á»£c hash báº±ng bcrypt
   - Token trong URL lÃ  token gá»‘c (chÆ°a hash)
   - Khi xÃ¡c thá»±c, hash token tá»« URL rá»“i so sÃ¡nh vá»›i DB

2. THá»œI GIAN Háº¾T Háº N
   - Má»—i link chá»‰ cÃ³ hiá»‡u lá»±c 15 phÃºt
   - Sau 15 phÃºt, link tá»± Ä‘á»™ng vÃ´ hiá»‡u
   - NgÆ°á»i dÃ¹ng pháº£i yÃªu cáº§u link má»›i

3. CHá»ˆ DÃ™NG 1 Láº¦N
   - Sau khi Ä‘Äƒng nháº­p thÃ nh cÃ´ng, used = true
   - Link khÃ´ng thá»ƒ dÃ¹ng láº¡i
   - NgÄƒn cháº·n viá»‡c chia sáº» link

4. KIá»‚M TRA EMAIL Tá»’N Táº I
   - Chá»‰ email Ä‘Ã£ Ä‘Äƒng kÃ½ má»›i nháº­n Ä‘Æ°á»£c link
   - NgÄƒn cháº·n spam vÃ  táº¥n cÃ´ng

================================================================================
ğŸ“Š SO SÃNH Vá»šI ÄÄ‚NG NHáº¬P THÃ”NG THÆ¯á»œNG
================================================================================

ÄÄ‚NG NHáº¬P THÃ”NG THÆ¯á»œNG          | MAGIC LINK
--------------------------------|------------------------------------------
Nháº­p email + máº­t kháº©u          | Chá»‰ nháº­p email
Cáº§n nhá»› máº­t kháº©u                | KhÃ´ng cáº§n nhá»› máº­t kháº©u
CÃ³ thá»ƒ Ä‘Äƒng nháº­p nhiá»u láº§n      | Link chá»‰ dÃ¹ng 1 láº§n
Máº­t kháº©u cÃ³ thá»ƒ bá»‹ lá»™           | Token tá»± Ä‘á»™ng háº¿t háº¡n
Cáº§n reset máº­t kháº©u náº¿u quÃªn     | Chá»‰ cáº§n yÃªu cáº§u link má»›i

================================================================================
ğŸ¯ KHI NÃ€O Sá»¬ Dá»¤NG MAGIC LINK?
================================================================================

âœ… PHÃ™ Há»¢P:
- NgÆ°á»i dÃ¹ng muá»‘n Ä‘Äƒng nháº­p nhanh
- QuÃªn máº­t kháº©u nhÆ°ng váº«n cÃ³ quyá»n truy cáº­p email
- Muá»‘n tráº£i nghiá»‡m Ä‘Äƒng nháº­p Ä‘Æ¡n giáº£n
- Thiáº¿t bá»‹ cÃ´ng cá»™ng (khÃ´ng muá»‘n nháº­p máº­t kháº©u)

âŒ KHÃ”NG PHÃ™ Há»¢P:
- Email khÃ´ng an toÃ n
- Cáº§n báº£o máº­t cao (nÃªn dÃ¹ng 2FA)
- KhÃ´ng cÃ³ quyá»n truy cáº­p email ngay láº­p tá»©c

================================================================================
ğŸ“ CODE LIÃŠN QUAN
================================================================================

1. Controller: TalentLoginController.php
   - sendMagicLink(): Gá»­i magic link
   - loginWithMagicLink(): XÃ¡c thá»±c vÃ  Ä‘Äƒng nháº­p

2. Model: MagicLink.php
   - isValid(): Kiá»ƒm tra token cÃ²n há»£p lá»‡ khÃ´ng
   - markAsUsed(): ÄÃ¡nh dáº¥u Ä‘Ã£ sá»­ dá»¥ng

3. Mail: MagicLinkMail.php
   - Gá»­i email chá»©a link Ä‘Äƒng nháº­p

4. Routes:
   - POST /talent/login/magic-link â†’ Gá»­i link
   - GET /talent/login/magic/{token} â†’ ÄÄƒng nháº­p báº±ng link

================================================================================
ğŸ”— LIÃŠN Káº¾T Vá»šI CÃC Báº¢NG KHÃC
================================================================================

Báº£ng magic_links KHÃ”NG cÃ³ foreign key trá»±c tiáº¿p, nhÆ°ng:
- email: Tham chiáº¿u Ä‘áº¿n email trong báº£ng 'talent' hoáº·c 'client'
- user_type: XÃ¡c Ä‘á»‹nh loáº¡i ngÆ°á»i dÃ¹ng ('talent' hoáº·c 'client')

Khi xÃ¡c thá»±c thÃ nh cÃ´ng:
- TÃ¬m user trong báº£ng 'talent' hoáº·c 'client' dá»±a vÃ o email
- ÄÄƒng nháº­p user Ä‘Ã³ vÃ o há»‡ thá»‘ng

================================================================================
ğŸ“Œ TÃ“M Táº®T
================================================================================

Báº£ng magic_links dÃ¹ng Ä‘á»ƒ:
âœ… ÄÄƒng nháº­p khÃ´ng cáº§n máº­t kháº©u
âœ… Gá»­i link Ä‘Äƒng nháº­p qua email
âœ… Báº£o máº­t báº±ng token cÃ³ thá»i háº¡n
âœ… Chá»‰ dÃ¹ng 1 láº§n
âœ… Há»— trá»£ cáº£ talent vÃ  client

Lá»£i Ã­ch:
- Tráº£i nghiá»‡m ngÆ°á»i dÃ¹ng tá»‘t hÆ¡n
- Giáº£m tá»· lá»‡ quÃªn máº­t kháº©u
- ÄÄƒng nháº­p nhanh chÃ³ng
- Báº£o máº­t tá»‘t vá»›i token cÃ³ thá»i háº¡n

================================================================================
NgÃ y táº¡o: 2025-12-11
================================================================================

